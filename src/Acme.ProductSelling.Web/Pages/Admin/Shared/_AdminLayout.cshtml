@using System.Globalization
@using Volo.Abp.AspNetCore.Mvc.UI.Theme.Shared;
@using Volo.Abp.AspNetCore.Mvc.UI.Theme.Basic.Bundling;
@using Volo.Abp.AspNetCore.Mvc.UI.Theme.LeptonXLite;
@using Volo.Abp.AspNetCore.Mvc.UI.Theme.LeptonXLite.Bundling;
@using Volo.Abp.AspNetCore.Mvc.UI.Theme.LeptonXLite.Languages;
@using Acme.ProductSelling.Web.Themes.LeptonXLite.Components.Toolbar.LanguageSwitch
@using Volo.Abp.AspNetCore.Mvc.UI.Theme.Basic.Themes.Basic.Components.Menu
@using Acme.ProductSelling.Localization
@using Microsoft.Extensions.Localization
@using Microsoft.AspNetCore.Authorization
@using Acme.ProductSelling.Permissions
@using Volo.Abp.Users
@using Volo.Abp.AspNetCore.Mvc.UI.RazorPages
@using Volo.Abp.AspNetCore.Mvc.UI.Bundling
@using Volo.Abp.UI.Navigation
@* @using Acme.ProductSelling.Web.Themes.LeptonXLite.Components.Menu *@
@inject ICurrentUser CurrentUser
@inject IStringLocalizer<ProductSellingResource> L
@inject IAuthorizationService AuthorizationService
@inject IMenuManager MenuManager



<!DOCTYPE html>
<html lang="@CultureInfo.CurrentUICulture.Name">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>@ViewBag.Title</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="~/libs/bootstrap/css/bootstrap.min.css" rel="stylesheet" />

    <abp-style-bundle name="@LeptonXLiteThemeBundles.Styles.Global" />

    <link href="~/css/admin/main/style.css" rel="stylesheet" />
    <link href="https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css"
          rel="stylesheet" />
    @await RenderSectionAsync("styles", required: false)

</head>
<body>

    <!-- Main Content -->

    <header class="header">
        <button class="toggle-btn" id="toggleBtn">
            <i class="fa-solid fa-bars"></i>
        </button>
        <div class="header-title">Dashboard</div>
    </header>

    <!-- Sidebar -->
    @* @await Component.InvokeAsync(typeof(Acme.ProductSelling.Web.Themes.LeptonXLite.Components.Menu.MainNavbarMenuViewComponent)) *@
    <aside class="sidebar" id="sidebar">
        @{
            var mainMenu = await MenuManager.GetAsync(StandardMenus.Main);
            var currentPath = Context.Request.Path.Value?.TrimEnd('/') ?? "";
        }

        @functions {
            public bool IsMenuItemActive(ApplicationMenuItem menuItem, string currentPath)
            {
                var menuItemUrl = menuItem.Url?.TrimEnd('/') ?? "";
                if (!string.IsNullOrEmpty(menuItemUrl) && currentPath.Equals(menuItemUrl, StringComparison.OrdinalIgnoreCase))
                {
                    return true;
                }
                if (!menuItem.Items.Any())
                {
                    return false;
                }
                return menuItem.Items.Any(subItem => IsMenuItemActive(subItem, currentPath));
            }
        }

        <ul style="list-style: none; padding: 0;">
            @await Html.PartialAsync("~/Pages/Admin/Shared/_MenuPartial.cshtml", mainMenu.Items, new ViewDataDictionary(ViewData)
            {
                { "CurrentPath", currentPath },
                        { "Level", 1 },
                        { "IsActiveChecker", (Func<ApplicationMenuItem, string, bool>)IsMenuItemActive }
            })
        </ul>
    </aside>

    <!-- Main Content Area -->
    <main class="main-content" id="mainContent">
        @RenderBody()
    </main>


    <script src="~/libs/abp/core/abp.js"></script>
    <abp-script-bundle name="@LeptonXLiteThemeBundles.Scripts.Global" />
    <abp-script-bundle name="Admin.Global" />

    <script src="~/Abp/ServiceProxyScript" asp-append-version="true"></script>
    <script src="~/Abp/ApplicationLocalizationScript?cultureName=@CultureInfo.CurrentUICulture.Name"></script>

    @await RenderSectionAsync("scripts", required: false)

</body>
</html>

