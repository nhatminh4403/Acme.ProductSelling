@* Location: Pages/Shared/Components/PriceFilter/_PriceFilter.cshtml *@
@model Acme.ProductSelling.Web.Pages.Components.PriceFilter.PriceFilterViewModel
@using Acme.ProductSelling.Localization
@inject IStringLocalizer<ProductSellingResource> L

<div class="filter-bar">
    <button type="button" class="price-filter-button" id="priceFilterToggle">
        <i class="bi bi-funnel"></i>
        <span>@L["UI:Price"]</span>
        <i class="bi bi-chevron-down ms-1" style="font-size: 12px;"></i>
    </button>

    <div class="active-filters" id="activeFilters">
        <i class="bi bi-tag"></i>
        <span id="currentPriceRange"></span>
        <button type="button" class="clear-btn" id="clearPriceFilter" title="@L["UI:ClearFilter"]">
            <i class="bi bi-x-circle"></i>
        </button>
    </div>

    @* Price Filter Dropdown *@
    <div class="price-dropdown" id="priceDropdown">
        <div id="priceSlider"></div>

        <div class="price-inputs">
            <div class="price-input-wrapper">
                <input type="text"
                       id="minPriceInput"
                       class="form-control"
                       readonly>
            </div>
            <div class="price-input-wrapper">
                <input type="text"
                       id="maxPriceInput"
                       class="form-control"
                       readonly>
            </div>
        </div>

        @* Manufacturer Filter (Optional) *@
        @if (Model.ShowManufacturerFilter && Model.Manufacturers != null && Model.Manufacturers.Any())
        {
            <div class="manufacturer-filter-section">
                <label class="form-label fw-bold small">@L["UI:Manufacturer"]</label>
                <div class="manufacturer-list">
                    <div class="form-check">
                        <input class="form-check-input manufacturer-checkbox"
                               type="radio"
                               name="manufacturerFilter"
                               id="manufacturer-all"
                               value=""
                               checked>
                        <label class="form-check-label" for="manufacturer-all">
                            @L["UI:AllManufacturers"]
                        </label>
                    </div>
                    @foreach (var manufacturer in Model.Manufacturers)
                    {
                        <div class="form-check">
                            <input class="form-check-input manufacturer-checkbox"
                                   type="radio"
                                   name="manufacturerFilter"
                                   id="manufacturer-@manufacturer.Id"
                                   value="@manufacturer.Id"
                                   @(Model.SelectedManufacturerId == manufacturer.Id ? "checked" : "")>
                            <label class="form-check-label" for="manufacturer-@manufacturer.Id">
                                @manufacturer.Name <span class="text-muted small">(@manufacturer.ProductCount)</span>
                            </label>
                        </div>
                    }
                </div>
            </div>
        }

        <div class="price-dropdown-footer">
            <button type="button" class="btn-reset" id="resetFilter">
                <i class="bi bi-arrow-clockwise me-1"></i>@L["Deselect"]
            </button>
            <button type="button" class="btn-apply" id="applyFilter" disabled>
                @L["UI:ViewResults"]
            </button>
        </div>
    </div>

    @* Backdrop *@
    <div class="dropdown-backdrop" id="dropdownBackdrop"></div>
</div>

@* Initialize the filter configuration *@
<script>
    window.priceFilterConfig = {
        minBound: @Model.MinPriceBound,
        maxBound: @Model.MaxPriceBound,
        categorySlug: '@Model.CategorySlug',
        manufacturerSlug: '@Model.ManufacturerSlug',
        searchKeyword: '@Model.SearchKeyword',
        pageSize: @Model.PageSize,
        showManufacturerFilter: @Model.ShowManufacturerFilter.ToString().ToLower()
    };
</script>
